@typeparam TValue

@inherits InputSelect<TValue>

<DropdownButton @ref="DropdownButtonReference" class="@ButtonCssClass" ContainerCssClass="@ContainerCssClass" PopoverCssClass="@PopoverCssClass">
    <ChildContent>
        @if (ValueDisplayContent == null) {
            @CurrentValueAsString
        } else {
            @ValueDisplayContent(CurrentValue)
        }
    </ChildContent>
    
    <Dropdown>
        <CascadingValue Value="this">
            <ul class="p-1 bg-gray-700 rounded-lg border border-gray-600">
                @ChildContent
            </ul>
        </CascadingValue>
    </Dropdown>
</DropdownButton>

@code {
    [Parameter] public string? ContainerCssClass { get; set; }
    [Parameter] public string? ButtonCssClass { get; set; }
    [Parameter] public string? PopoverCssClass { get; set; }
    
    [Parameter] public RenderFragment<TValue?>? ValueDisplayContent { get; set; }
    
    public DropdownButton? DropdownButtonReference { get; set; }

    public void SetValue(TValue value) {
        DropdownButtonReference?.HideDropdown();
        CurrentValue = value;
    }
}