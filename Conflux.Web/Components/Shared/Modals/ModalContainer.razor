@rendermode InteractiveServer

@using Conflux.Web.Services.Implementations
@implements IDisposable

@inject ModalService ModalService

@foreach (var instance in ModalService.Modals) {
    <ModalElementContainer @key="instance.Id" Instance="instance"/>
}

@code {
    protected override void OnAfterRender(bool firstRender) {
        if (firstRender) {
            ModalService.OnModalChanged += OnModalChanged;
        }
    }

    private void OnModalChanged(ModalChangedEventArgs args) {
        StateHasChanged();
    }

    public void Dispose() {
        ModalService.OnModalChanged -= OnModalChanged;
    }
}