@using Conflux.Services
@using Conflux.Services.Implementations

@rendermode InteractiveServer

@implements IDisposable

@inject ModalService ModalService
@inject ILogger<ModalContainer> Logger

@foreach (var instance in ModalService.Modals) {
    <ModalElementContainer @key="instance.Id" Instance="instance"/>
}

@code {
    protected override void OnAfterRender(bool firstRender) {
        if (firstRender) {
            ModalService.OnModalChanged += OnModalChanged;
        }
    }

    private void OnModalChanged(ModalChangedEventArgs args) {
        StateHasChanged();
    }

    public void Dispose() {
        ModalService.OnModalChanged -= OnModalChanged;
    }
}