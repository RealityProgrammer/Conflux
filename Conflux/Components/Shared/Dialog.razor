<div class="cursor-default fixed inset-0 z-1000 pointer-events-none @_cssClass">
    <Overlay class="bg-transparent duration-200 ease-in-out" ActiveCssClass="bg-black/80!" OnClick="@OnClickOutside" @bind-Active="Open"/>
    
    <div class="transition-all duration-200 ease-in-out w-full @(Open ? "scale-100 opacity-100" : "scale-80 opacity-0") @ContainerCssClass">
        @if (Open) {
            @ChildContent
        }
    </div>
</div>

@code {
    [Parameter] public bool Open { get; set; }
    [Parameter] public EventCallback<bool> OpenChanged { get; set; }
    [Parameter] public Expression<Func<bool>>? OpenExpression { get; set; }

    [Parameter, EditorRequired] public required RenderFragment ChildContent { get; set; }

    [Parameter] public EventCallback<MouseEventArgs> OnClickOutside { get; set; }
    
    [Parameter] public string? ContainerCssClass { get; set; }
    
    [Parameter(CaptureUnmatchedValues = true)] public IReadOnlyDictionary<string, object>? AdditionalAttributes { get; set; }
    private string? _cssClass;

    protected override void OnParametersSet() {
        if (AdditionalAttributes != null && AdditionalAttributes.TryGetValue("class", out object? obj)) {
            _cssClass = Convert.ToString(obj);
        }

        AdditionalAttributes = AdditionalAttributes?.Where(x => x.Key is not "class").ToDictionary();
    }
}